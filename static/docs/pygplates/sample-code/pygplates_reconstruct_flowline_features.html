
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Reconstruct flowline features &#8212; pygplates 2.2.0.28 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hierarchy of plate rotations" href="pygplates_plate_rotation_hierarchy.html" />
    <link rel="prev" title="Reconstruct motion path features" href="pygplates_reconstruct_motion_path_features.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pygplates_plate_rotation_hierarchy.html" title="Hierarchy of plate rotations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pygplates_reconstruct_motion_path_features.html" title="Reconstruct motion path features"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pygplates 2.2.0.28 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../pygplates_sample_code.html" accesskey="U">Sample code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="reconstruct-flowline-features">
<span id="pygplates-reconstruct-flowline-features"></span><h1>Reconstruct flowline features<a class="headerlink" href="#reconstruct-flowline-features" title="Permalink to this headline">¶</a></h1>
<p>This example shows a couple of different scenarios involving the reconstruction of
<a class="reference external" href="http://www.gplates.org/docs/gpgim/#gpml:Flowline">flowline</a> features to geological times.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="pygplates_reconstruct_motion_path_features.html#pygplates-reconstruct-motion-path-features"><span class="std std-ref">Reconstruct motion path features</span></a></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="pygplates_reconstruct_regular_features.html#pygplates-reconstruct-regular-features"><span class="std std-ref">Reconstruct regular features</span></a></p>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#exported-reconstructed-flowlines-to-a-file" id="id5">Exported reconstructed flowlines to a file</a><ul>
<li><a class="reference internal" href="#sample-code" id="id6">Sample code</a></li>
<li><a class="reference internal" href="#details" id="id7">Details</a></li>
<li><a class="reference internal" href="#output" id="id8">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#query-a-reconstructed-flowline" id="id9">Query a reconstructed flowline</a><ul>
<li><a class="reference internal" href="#id2" id="id10">Sample code</a></li>
<li><a class="reference internal" href="#id3" id="id11">Details</a></li>
<li><a class="reference internal" href="#id4" id="id12">Output</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="exported-reconstructed-flowlines-to-a-file">
<span id="pygplates-export-reconstructed-flowlines-to-a-file"></span><h2><a class="toc-backref" href="#id5">Exported reconstructed flowlines to a file</a><a class="headerlink" href="#exported-reconstructed-flowlines-to-a-file" title="Permalink to this headline">¶</a></h2>
<p>In this example we reconstruct <a class="reference external" href="http://www.gplates.org/docs/gpgim/#gpml:Flowline">flowline</a>
features and export the results to a Shapefile.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="pygplates_create_common_feature_types.html#pygplates-create-flowline-feature"><span class="std std-ref">Create a flowline feature</span></a> and <a class="reference internal" href="pygplates_query_common_feature_types.html#pygplates-query-flowline-feature"><span class="std std-ref">Query a flowline feature</span></a></p>
</div>
<div class="section" id="sample-code">
<h3><a class="toc-backref" href="#id6">Sample code</a><a class="headerlink" href="#sample-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygplates</span>


<span class="c1"># Load one or more rotation files into a rotation model.</span>
<span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>

<span class="c1"># Load some flowline features.</span>
<span class="n">flowline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;flowline_features.gpml&#39;</span><span class="p">)</span>

<span class="c1"># Reconstruct features to this geological time.</span>
<span class="n">reconstruction_time</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># The filename of the exported reconstructed flowlines.</span>
<span class="c1"># It&#39;s a shapefile called &#39;flowline_output_50Ma.shp&#39;.</span>
<span class="n">export_filename</span> <span class="o">=</span> <span class="s1">&#39;flowline_output_</span><span class="si">{0}</span><span class="s1">Ma.shp&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reconstruction_time</span><span class="p">)</span>

<span class="c1"># Reconstruct the flowlines to the reconstruction time and export them to a shapefile.</span>
<span class="n">pygplates</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">flowline_features</span><span class="p">,</span> <span class="n">rotation_model</span><span class="p">,</span> <span class="n">export_filename</span><span class="p">,</span> <span class="n">reconstruction_time</span><span class="p">,</span>
    <span class="n">reconstruct_type</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ReconstructType</span><span class="o">.</span><span class="n">flowline</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="details">
<h3><a class="toc-backref" href="#id7">Details</a><a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h3>
<p>The rotations are loaded from a rotation file into a <a class="reference internal" href="../generated/pygplates.RotationModel.html#pygplates.RotationModel" title="pygplates.RotationModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.RotationModel</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The flowline features are loaded into a <a class="reference internal" href="../generated/pygplates.FeatureCollection.html#pygplates.FeatureCollection" title="pygplates.FeatureCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.FeatureCollection</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flowline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;flowline_features.gpml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The flowline features will be reconstructed to their 50Ma positions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstruction_time</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">All flowline features are reconstructed to 50Ma using <a class="reference internal" href="../generated/pygplates.reconstruct.html#pygplates.reconstruct" title="pygplates.reconstruct"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygplates.reconstruct()</span></code></a>.</div>
<div class="line">We specify we only want to reconstruct flowline features by specifying
<code class="docutils literal notranslate"><span class="pre">pygplates.ReconstructType.flowline</span></code> for the <em>reconstruct_type</em> argument.</div>
<div class="line">We specify a filename to export the reconstructed geometries to.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pygplates</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">flowline_features</span><span class="p">,</span> <span class="n">rotation_model</span><span class="p">,</span> <span class="n">export_filename</span><span class="p">,</span> <span class="n">reconstruction_time</span><span class="p">,</span>
    <span class="n">reconstruct_type</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ReconstructType</span><span class="o">.</span><span class="n">flowline</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="output">
<h3><a class="toc-backref" href="#id8">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>We should now have a file called <code class="docutils literal notranslate"><span class="pre">flowline_output_50Ma.shp</span></code> containing the flowlines
reconstructed to their 50Ma positions.</p>
</div>
</div>
<div class="section" id="query-a-reconstructed-flowline">
<span id="pygplates-query-reconstructed-flowline"></span><h2><a class="toc-backref" href="#id9">Query a reconstructed flowline</a><a class="headerlink" href="#query-a-reconstructed-flowline" title="Permalink to this headline">¶</a></h2>
<p>In this example we print out the point locations in a reconstructed flowline.</p>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id10">Sample code</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygplates</span>


<span class="c1"># Specify two (lat/lon) seed points on a present-day mid-ocean ridge between plates 201 and 701.</span>
<span class="n">seed_points</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">MultiPointOnSphere</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">35.547600</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.873000</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">46.208000</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.623000</span><span class="p">)</span>
    <span class="p">])</span>

<span class="c1"># A list of times to sample flowline - from 0 to 90Ma in 5My intervals.</span>
<span class="n">times</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Create a flowline feature.</span>
<span class="n">flowline_feature</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">Feature</span><span class="o">.</span><span class="n">create_flowline</span><span class="p">(</span>
        <span class="n">seed_points</span><span class="p">,</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">valid_time</span><span class="o">=</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">times</span><span class="p">)),</span>
        <span class="n">left_plate</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>
        <span class="n">right_plate</span><span class="o">=</span><span class="mi">701</span><span class="p">)</span>

<span class="c1"># Load one or more rotation files into a rotation model.</span>
<span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>

<span class="c1"># Reconstruct features to this geological time.</span>
<span class="n">reconstruction_time</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Reconstruct the flowline feature to the reconstruction time.</span>
<span class="n">reconstructed_flowlines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pygplates</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">flowline_feature</span><span class="p">,</span> <span class="n">rotation_model</span><span class="p">,</span> <span class="n">reconstructed_flowlines</span><span class="p">,</span> <span class="n">reconstruction_time</span><span class="p">,</span>
    <span class="n">reconstruct_type</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ReconstructType</span><span class="o">.</span><span class="n">flowline</span><span class="p">)</span>

<span class="c1"># Iterate over all reconstructed flowlines.</span>
<span class="c1"># There will be two (one for each seed point).</span>
<span class="k">for</span> <span class="n">reconstructed_flowline</span> <span class="ow">in</span> <span class="n">reconstructed_flowlines</span><span class="p">:</span>

    <span class="c1"># Print the flowline left/right plate IDs.</span>
    <span class="nb">print</span> <span class="s1">&#39;flowline: left </span><span class="si">%d</span><span class="s1">, right </span><span class="si">%d</span><span class="s1"> at </span><span class="si">%f</span><span class="s1">Ma&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_feature</span><span class="p">()</span><span class="o">.</span><span class="n">get_left_plate</span><span class="p">(),</span>
        <span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_feature</span><span class="p">()</span><span class="o">.</span><span class="n">get_right_plate</span><span class="p">(),</span>
        <span class="n">reconstruction_time</span><span class="p">)</span>

    <span class="c1"># Print the reconstructed seed point location.</span>
    <span class="nb">print</span> <span class="s1">&#39;  reconstructed seed point: lat: </span><span class="si">%f</span><span class="s1">, lon: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_reconstructed_seed_point</span><span class="p">()</span><span class="o">.</span><span class="n">to_lat_lon</span><span class="p">()</span>

    <span class="n">flowline_times</span> <span class="o">=</span> <span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_feature</span><span class="p">()</span><span class="o">.</span><span class="n">get_times</span><span class="p">()</span>

    <span class="nb">print</span> <span class="s1">&#39;  left flowline:&#39;</span>

    <span class="c1"># Iterate over the left points in the flowline.</span>
    <span class="c1"># The first point in the path is the youngest and the last point is the oldest.</span>
    <span class="c1"># So we reverse the order to start with the oldest.</span>
    <span class="k">for</span> <span class="n">point_index</span><span class="p">,</span> <span class="n">left_point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_left_flowline</span><span class="p">())):</span>

        <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">left_point</span><span class="o">.</span><span class="n">to_lat_lon</span><span class="p">()</span>

        <span class="c1"># The first point in the path is the oldest and the last point is the reconstructed seed point.</span>
        <span class="c1"># So we need to start at the last time and work our way backwards.</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">flowline_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">point_index</span><span class="p">]</span>

        <span class="c1"># Print the point location and the time associated with it.</span>
        <span class="nb">print</span> <span class="s1">&#39;    time: </span><span class="si">%f</span><span class="s1">, lat: </span><span class="si">%f</span><span class="s1">, lon: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>

    <span class="nb">print</span> <span class="s1">&#39;  right flowline:&#39;</span>

    <span class="c1"># Iterate over the right points in the flowline.</span>
    <span class="c1"># The first point in the path is the youngest and the last point is the oldest.</span>
    <span class="c1"># So we reverse the order to start with the oldest.</span>
    <span class="k">for</span> <span class="n">point_index</span><span class="p">,</span> <span class="n">right_point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_right_flowline</span><span class="p">())):</span>

        <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">right_point</span><span class="o">.</span><span class="n">to_lat_lon</span><span class="p">()</span>

        <span class="c1"># The first point in the path is the oldest and the last point is the reconstructed seed point.</span>
        <span class="c1"># So we need to start at the last time and work our way backwards.</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">flowline_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">point_index</span><span class="p">]</span>

        <span class="c1"># Print the point location and the time associated with it.</span>
        <span class="nb">print</span> <span class="s1">&#39;    time: </span><span class="si">%f</span><span class="s1">, lat: </span><span class="si">%f</span><span class="s1">, lon: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id11">Details</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The first part of this example comes from <a class="reference internal" href="pygplates_create_common_feature_types.html#pygplates-create-flowline-feature"><span class="std std-ref">Create a flowline feature</span></a>.</div>
<div class="line">It creates a flowline feature specifying the seed point locations that each flowline spreads
from as well as a list of times to plot points in the left/right paths.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seed_points</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">MultiPointOnSphere</span><span class="p">([(</span><span class="o">-</span><span class="mf">35.547600</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.873000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">46.208000</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.623000</span><span class="p">)])</span>
<span class="n">times</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">flowline_feature</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">Feature</span><span class="o">.</span><span class="n">create_flowline</span><span class="p">(</span>
        <span class="n">seed_points</span><span class="p">,</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">valid_time</span><span class="o">=</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">times</span><span class="p">)),</span>
        <span class="n">left_plate</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>
        <span class="n">right_plate</span><span class="o">=</span><span class="mi">701</span><span class="p">)</span>
</pre></div>
</div>
<p>The rotations are loaded from a rotation file into a <a class="reference internal" href="../generated/pygplates.RotationModel.html#pygplates.RotationModel" title="pygplates.RotationModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.RotationModel</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The features will be reconstructed to their 50Ma positions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstruction_time</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The flowline feature is reconstructed to 50Ma using <a class="reference internal" href="../generated/pygplates.reconstruct.html#pygplates.reconstruct" title="pygplates.reconstruct"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygplates.reconstruct()</span></code></a>.</div>
<div class="line">We specify a <code class="docutils literal notranslate"><span class="pre">list</span></code> for <em>reconstructed_flowlines</em> instead of a filename so that we
can query the reconstructed flowlines easily.</div>
<div class="line">We also specify we only want to reconstruct flowline features by specifying
<code class="docutils literal notranslate"><span class="pre">pygplates.ReconstructType.flowline</span></code> for the <em>reconstruct_type</em> argument.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_flowlines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pygplates</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">flowline_feature</span><span class="p">,</span> <span class="n">rotation_model</span><span class="p">,</span> <span class="n">reconstructed_flowlines</span><span class="p">,</span> <span class="n">reconstruction_time</span><span class="p">,</span>
    <span class="n">reconstruct_type</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ReconstructType</span><span class="o">.</span><span class="n">flowline</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">We iterate over the points in the <a class="reference internal" href="../generated/pygplates.ReconstructedFlowline.html#pygplates.ReconstructedFlowline.get_left_flowline" title="pygplates.ReconstructedFlowline.get_left_flowline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reconstructed</span> <span class="pre">left</span> <span class="pre">flowline</span></code></a>
and print each point location and its associated time.</div>
<div class="line">The first point in a flowline path is the youngest and the last point is the oldest.
We reverse that order so that we start with the oldest point first since there is always a point
in the path corresponding to the oldest time, but there is not always a point corresponding to the
youngest time (present day). However when we index into the flowline times we again need to
reverse our indexing order (since the times array goes from youngest to oldest).
So we need to start at the last (oldest) time and work our way backwards.
The last sample is at index <code class="docutils literal notranslate"><span class="pre">-1</span></code> and <code class="docutils literal notranslate"><span class="pre">point_index</span></code> starts at zero.
So our time indices are <code class="docutils literal notranslate"><span class="pre">-1</span></code>, <code class="docutils literal notranslate"><span class="pre">-2</span></code>, etc, which means last sample, then second last sample, etc.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">point_index</span><span class="p">,</span> <span class="n">left_point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">reconstructed_flowline</span><span class="o">.</span><span class="n">get_left_flowline</span><span class="p">())):</span>
    <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">left_point</span><span class="o">.</span><span class="n">to_lat_lon</span><span class="p">()</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">flowline_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">point_index</span><span class="p">]</span>
    <span class="nb">print</span> <span class="s1">&#39;    time: </span><span class="si">%f</span><span class="s1">, lat: </span><span class="si">%f</span><span class="s1">, lon: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we do the same thing for the <a class="reference internal" href="../generated/pygplates.ReconstructedFlowline.html#pygplates.ReconstructedFlowline.get_right_flowline" title="pygplates.ReconstructedFlowline.get_right_flowline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reconstructed</span> <span class="pre">right</span> <span class="pre">flowline</span></code></a>.</p>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id12">Output</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Our time range is 90Ma to 0Ma, but since the reconstruction time is 50Ma the output is only
from 90Ma to 50Ma.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flowline</span><span class="p">:</span> <span class="n">left</span> <span class="mi">201</span><span class="p">,</span> <span class="n">right</span> <span class="mi">701</span> <span class="n">at</span> <span class="mf">50.000000</span><span class="n">Ma</span>
  <span class="n">reconstructed</span> <span class="n">seed</span> <span class="n">point</span><span class="p">:</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.850694</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">16.014821</span>
  <span class="n">left</span> <span class="n">flowline</span><span class="p">:</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">90.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.901733</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">27.101972</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">85.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.656544</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.013022</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">80.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.483824</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">23.206460</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">75.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.334783</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">21.521684</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">70.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.162941</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">19.844649</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">65.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">40.040648</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">18.640309</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">60.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.971463</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">17.834474</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">55.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.903776</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">16.997535</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">50.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.850694</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">16.014821</span>
  <span class="n">right</span> <span class="n">flowline</span><span class="p">:</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">90.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.122807</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.288718</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">85.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.647048</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.218192</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">80.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.993610</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.936790</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">75.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.256681</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">10.566648</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">70.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.498386</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.207892</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">65.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.646000</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.398159</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">60.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.723847</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">14.198892</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">55.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.796142</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">15.033014</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">50.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">39.850694</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">16.014821</span>
<span class="n">flowline</span><span class="p">:</span> <span class="n">left</span> <span class="mi">201</span><span class="p">,</span> <span class="n">right</span> <span class="mi">701</span> <span class="n">at</span> <span class="mf">50.000000</span><span class="n">Ma</span>
  <span class="n">reconstructed</span> <span class="n">seed</span> <span class="n">point</span><span class="p">:</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.546458</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">11.620705</span>
  <span class="n">left</span> <span class="n">flowline</span><span class="p">:</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">90.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">51.886602</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">24.489162</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">85.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">51.571835</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">21.855842</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">80.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">51.343265</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">19.679682</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">75.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">51.144581</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">17.701380</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">70.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.919599</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">15.739301</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">65.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.765425</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">14.377055</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">60.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.684497</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.516892</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">55.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.605968</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.631013</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">50.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.546458</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">11.620705</span>
  <span class="n">right</span> <span class="n">flowline</span><span class="p">:</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">90.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">48.420517</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="mf">0.540404</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">85.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">49.070539</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.777819</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">80.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">49.499811</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.780529</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">75.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">49.827249</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.651092</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">70.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.130910</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.543508</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">65.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.312577</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.879531</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">60.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.402339</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.730844</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">55.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.485515</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">10.611898</span>
    <span class="n">time</span><span class="p">:</span> <span class="mf">50.000000</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.546458</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">11.620705</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The reconstructed seed point is the same position as the last point in the left and right flowlines.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Reconstruct flowline features</a><ul>
<li><a class="reference internal" href="#exported-reconstructed-flowlines-to-a-file">Exported reconstructed flowlines to a file</a><ul>
<li><a class="reference internal" href="#sample-code">Sample code</a></li>
<li><a class="reference internal" href="#details">Details</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#query-a-reconstructed-flowline">Query a reconstructed flowline</a><ul>
<li><a class="reference internal" href="#id2">Sample code</a></li>
<li><a class="reference internal" href="#id3">Details</a></li>
<li><a class="reference internal" href="#id4">Output</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pygplates_reconstruct_motion_path_features.html"
                        title="previous chapter">Reconstruct motion path features</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pygplates_plate_rotation_hierarchy.html"
                        title="next chapter">Hierarchy of plate rotations</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/sample-code/pygplates_reconstruct_flowline_features.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pygplates_plate_rotation_hierarchy.html" title="Hierarchy of plate rotations"
             >next</a> |</li>
        <li class="right" >
          <a href="pygplates_reconstruct_motion_path_features.html" title="Reconstruct motion path features"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pygplates 2.2.0.28 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../pygplates_sample_code.html" >Sample code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright (C) 2003-2020 The University of Sydney, Australia
(C) 2004-2020 California Institute of Technology
(C) 2007-2020 The Geological Survey of Norway
.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>