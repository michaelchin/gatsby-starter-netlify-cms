
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Import geometries and assign plate IDs &#8212; pygplates 2.2.0.28 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Load and save feature collections" href="pygplates_load_and_save_feature_collections.html" />
    <link rel="prev" title="Sample code" href="../pygplates_sample_code.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pygplates_load_and_save_feature_collections.html" title="Load and save feature collections"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../pygplates_sample_code.html" title="Sample code"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pygplates 2.2.0.28 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../pygplates_sample_code.html" accesskey="U">Sample code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="import-geometries-and-assign-plate-ids">
<span id="pygplates-import-geometries-and-assign-plate-ids"></span><h1>Import geometries and assign plate IDs<a class="headerlink" href="#import-geometries-and-assign-plate-ids" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to import points or polylines from a text file and assign plate IDs to them.
The resulting feature data is then saved to a file format that pyGPlates can load directly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Importing features is different than <a class="reference internal" href="pygplates_load_and_save_feature_collections.html#pygplates-load-and-save-feature-collections"><span class="std std-ref">loading</span></a> features.
When feature data is not in a file format that pyGPlates can load then it needs to be imported into a
GPlates-compatible file format. This usually involves more than just importing the geometry data.
For example, plate IDs need to be assigned so that pyGPlates can reconstruct the feature data
to geological times. And other feature metadata such as <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_name" title="pygplates.Feature.set_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">name</span></code></a> and
<a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_description" title="pygplates.Feature.set_description"><code class="xref py py-meth docutils literal notranslate"><span class="pre">description</span></code></a> should also be assigned.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="pygplates_load_and_save_feature_collections.html#pygplates-load-and-save-feature-collections"><span class="std std-ref">Load and save feature collections</span></a></p>
</div>
<div class="line-block">
<div class="line">The first two examples import <em>points</em>.</div>
<div class="line">The second two examples import <em>polylines</em>.</div>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#import-points-from-a-text-file-and-assign-plate-ids" id="id12">Import <em>points</em> from a text file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#sample-code" id="id13">Sample code</a></li>
<li><a class="reference internal" href="#input" id="id14">Input</a></li>
<li><a class="reference internal" href="#details" id="id15">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-points-from-a-gmt-file-and-assign-plate-ids" id="id16">Load <em>points</em> from a GMT file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#id1" id="id17">Sample code</a></li>
<li><a class="reference internal" href="#id2" id="id18">Input</a></li>
<li><a class="reference internal" href="#id3" id="id19">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#import-polylines-from-a-text-file-and-assign-plate-ids" id="id20">Import <em>polylines</em> from a text file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#id5" id="id21">Sample code</a></li>
<li><a class="reference internal" href="#id6" id="id22">Input</a></li>
<li><a class="reference internal" href="#id7" id="id23">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-polylines-from-a-gmt-file-and-assign-plate-ids" id="id24">Load <em>polylines</em> from a GMT file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#id8" id="id25">Sample code</a></li>
<li><a class="reference internal" href="#id9" id="id26">Input</a></li>
<li><a class="reference internal" href="#id10" id="id27">Details</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="import-points-from-a-text-file-and-assign-plate-ids">
<span id="pygplates-import-points-from-a-text-file-and-assign-plate-ids"></span><h2><a class="toc-backref" href="#id12">Import <em>points</em> from a text file and assign plate IDs</a><a class="headerlink" href="#import-points-from-a-text-file-and-assign-plate-ids" title="Permalink to this headline">¶</a></h2>
<p>This example:</p>
<ul class="simple">
<li>reads some point locations from a text file,</li>
<li>assigns a plate ID and valid time period to each point, and</li>
<li>writes the assigned points to a GPML file ready for use in <a class="reference external" href="http://www.gplates.org">GPlates</a>.</li>
</ul>
<div class="section" id="sample-code">
<h3><a class="toc-backref" href="#id13">Sample code</a><a class="headerlink" href="#sample-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygplates</span>


<span class="c1"># Load one or more rotation files into a rotation model.</span>
<span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>

<span class="c1"># The static polygons file will be used to assign plate IDs and valid time periods.</span>
<span class="n">static_polygons_filename</span> <span class="o">=</span> <span class="s1">&#39;static_polygons.gpml&#39;</span>

<span class="c1"># Filename of the input points file that we will read.</span>
<span class="n">input_points_filename</span> <span class="o">=</span> <span class="s1">&#39;input_points.txt&#39;</span>

<span class="c1"># Filename of the output points file that we will write.</span>
<span class="c1"># Note that it is a GPML file (has extension &#39;.gpml&#39;).</span>
<span class="c1"># This enables it to be read into GPlates.</span>
<span class="n">output_points_filename</span> <span class="o">=</span> <span class="s1">&#39;output_points.gpml&#39;</span>

<span class="c1"># Parse the input points text file containing a lon/lat point per line.</span>
<span class="c1"># Longitude/latitude is the order that GMT files (&#39;.xy&#39;, &#39;.gmt&#39;) use.</span>
<span class="c1"># Note that pyGPlates specifies points in the opposite (latitude/longitude) order.</span>
<span class="n">input_points</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_points_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_points_file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_points_file</span><span class="p">):</span>

        <span class="c1"># Make line number 1-based instead of 0-based.</span>
        <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># Split the line into strings (separated by whitespace).</span>
        <span class="n">line_string_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="c1"># Need at least two strings per line (for latitude and longitude).</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring point - line does not have at least two white-space separated strings.&#39;</span> <span class="o">%</span> <span class="n">line_number</span>
            <span class="k">continue</span>

        <span class="c1"># Attempt to convert each string into a floating-point number.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Use GMT (lon/lat) order.</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring point - cannot read lon/lat values.&#39;</span> <span class="o">%</span> <span class="n">line_number</span>
            <span class="k">continue</span>

        <span class="c1"># Create a pyGPlates point from the latitude and longitude, and add it to our list of points.</span>
        <span class="c1"># Note that pyGPlates uses the opposite (lat/lon) order to GMT (lon/lat).</span>
        <span class="n">input_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pygplates</span><span class="o">.</span><span class="n">PointOnSphere</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">))</span>

<span class="c1"># Create a feature for each point we read from the input file.</span>
<span class="n">point_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">input_points</span><span class="p">:</span>

    <span class="c1"># Create an unclassified feature.</span>
    <span class="n">point_feature</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">Feature</span><span class="p">()</span>

    <span class="c1"># Set the feature&#39;s geometry to the input point read from the text file.</span>
    <span class="n">point_feature</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

    <span class="n">point_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point_feature</span><span class="p">)</span>

<span class="c1"># Use the static polygons to assign plate IDs and valid time periods.</span>
<span class="c1"># Each point feature is partitioned into one of the static polygons and assigned its</span>
<span class="c1"># reconstruction plate ID and valid time period.</span>
<span class="n">assigned_point_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">partition_into_plates</span><span class="p">(</span>
    <span class="n">static_polygons_filename</span><span class="p">,</span>
    <span class="n">rotation_model</span><span class="p">,</span>
    <span class="n">point_features</span><span class="p">,</span>
    <span class="n">properties_to_copy</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">reconstruction_plate_id</span><span class="p">,</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">valid_time_period</span><span class="p">])</span>

<span class="c1"># Write the assigned point features to the output GPML file (ready for use in GPlates).</span>
<span class="n">assigned_point_feature_collection</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">assigned_point_features</span><span class="p">)</span>
<span class="n">assigned_point_feature_collection</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_points_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="input">
<h3><a class="toc-backref" href="#id14">Input</a><a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h3>
<p>An example input text file (in longitude/latitude order) looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">79.747867</span>      <span class="o">-</span><span class="mf">1.444159</span>
<span class="o">-</span><span class="mf">79.786712</span>      <span class="o">-</span><span class="mf">1.654002</span>
<span class="o">-</span><span class="mf">79.872547</span>      <span class="o">-</span><span class="mf">2.221801</span>
<span class="o">-</span><span class="mf">79.858122</span>      <span class="o">-</span><span class="mf">6.951201</span>
<span class="o">-</span><span class="mf">78.850008</span>      <span class="o">-</span><span class="mf">9.359851</span>
<span class="o">-</span><span class="mf">76.020448</span>      <span class="o">-</span><span class="mf">13.798207</span>
<span class="o">-</span><span class="mf">75.549659</span>      <span class="o">-</span><span class="mf">14.315297</span>
<span class="o">-</span><span class="mf">75.411320</span>      <span class="o">-</span><span class="mf">14.456342</span>
<span class="o">-</span><span class="mf">74.335501</span>      <span class="o">-</span><span class="mf">15.543422</span>
<span class="o">-</span><span class="mf">72.539796</span>      <span class="o">-</span><span class="mf">17.187214</span>
<span class="o">-</span><span class="mf">71.922547</span>      <span class="o">-</span><span class="mf">17.773935</span>
<span class="o">-</span><span class="mf">71.381735</span>      <span class="o">-</span><span class="mf">18.373316</span>
<span class="o">-</span><span class="mf">70.979182</span>      <span class="o">-</span><span class="mf">18.850190</span>
<span class="o">-</span><span class="mf">70.786266</span>      <span class="o">-</span><span class="mf">19.126329</span>
<span class="o">-</span><span class="mf">70.571175</span>      <span class="o">-</span><span class="mf">19.417365</span>
<span class="o">-</span><span class="mf">70.343507</span>      <span class="o">-</span><span class="mf">19.716224</span>
<span class="o">-</span><span class="mf">70.280285</span>      <span class="o">-</span><span class="mf">19.858811</span>
<span class="o">-</span><span class="mf">70.107565</span>      <span class="o">-</span><span class="mf">20.531859</span>
<span class="o">-</span><span class="mf">70.059697</span>      <span class="o">-</span><span class="mf">22.248895</span>
</pre></div>
</div>
</div>
<div class="section" id="details">
<h3><a class="toc-backref" href="#id15">Details</a><a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h3>
<p>The rotations are loaded from a rotation file into a <a class="reference internal" href="../generated/pygplates.RotationModel.html#pygplates.RotationModel" title="pygplates.RotationModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.RotationModel</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The points will be read from an input text file and written to an output GPML file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_points_filename</span> <span class="o">=</span> <span class="s1">&#39;input_points.txt&#39;</span>
<span class="n">output_points_filename</span> <span class="o">=</span> <span class="s1">&#39;output_points.gpml&#39;</span>
</pre></div>
</div>
<p>The input points file is opened and read line-by-line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_points_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_points_file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_points_file</span><span class="p">):</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Each line contains a latitude string and a longitude string.</div>
<div class="line">We attempt to convert them to floating-point numbers.</div>
<div class="line">If that fails then we catch the <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception that Python raises and ignore that line in the file.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring point - cannot read lon/lat values.&#39;</span> <span class="o">%</span> <span class="n">line_number</span>
    <span class="k">continue</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">An unclassified feature is created for each point we read from the input file.
Leaving the feature type empty in <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.__init__" title="pygplates.Feature.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.Feature()</span></code></a>
defaults to a feature type of <code class="docutils literal notranslate"><span class="pre">pygplates.FeatureType.gpml_unclassified_feature</span></code>.</div>
<div class="line">Ideally we should pick a specific feature type such as
<a class="reference external" href="http://www.gplates.org/docs/gpgim/#gpml:HotSpot">pygplates.FeatureType.gpml_hot_spot</a>,
perhaps reading it from the input file (as an extra column).</div>
<div class="line">And ideally we should also import extra metadata such as feature <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_name" title="pygplates.Feature.set_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">name</span></code></a>
and <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_description" title="pygplates.Feature.set_description"><code class="xref py py-meth docutils literal notranslate"><span class="pre">description</span></code></a>.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point_feature</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">Feature</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The point geometry is set on the point feature using <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_geometry" title="pygplates.Feature.set_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.Feature.set_geometry()</span></code></a>.</div>
<div class="line">If we don’t do this then the feature cannot be used in spatial calculations and
will not display on the globe in GPlates.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point_feature</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Each point feature is partitioned into one of the static polygons and assigned its
reconstruction plate ID and valid time period using <a class="reference internal" href="../generated/pygplates.partition_into_plates.html#pygplates.partition_into_plates" title="pygplates.partition_into_plates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygplates.partition_into_plates()</span></code></a>.</div>
<div class="line">The static polygons have global coverage at present day (the default reconstruction time
for <a class="reference internal" href="../generated/pygplates.partition_into_plates.html#pygplates.partition_into_plates" title="pygplates.partition_into_plates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygplates.partition_into_plates()</span></code></a>) and should therefore partition all the input points.</div>
<div class="line">We also explicitly specify the argument <em>properties_to_copy</em> to assign both the reconstruction plate
ID and valid time period (the default is just to assign the reconstruction plate ID).</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">assigned_point_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">partition_into_plates</span><span class="p">(</span>
    <span class="n">static_polygons_filename</span><span class="p">,</span>
    <span class="n">rotation_model</span><span class="p">,</span>
    <span class="n">point_features</span><span class="p">,</span>
    <span class="n">properties_to_copy</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">reconstruction_plate_id</span><span class="p">,</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">valid_time_period</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally we put the list of assigned features into a <a class="reference internal" href="../generated/pygplates.FeatureCollection.html#pygplates.FeatureCollection" title="pygplates.FeatureCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.FeatureCollection</span></code></a> so that
we can write them out to a file using <a class="reference internal" href="../generated/pygplates.FeatureCollection.html#pygplates.FeatureCollection.write" title="pygplates.FeatureCollection.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.FeatureCollection.write()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">assigned_point_feature_collection</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">assigned_point_features</span><span class="p">)</span>
<span class="n">assigned_point_feature_collection</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_points_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-points-from-a-gmt-file-and-assign-plate-ids">
<span id="pygplates-import-points-from-a-gmt-file-and-assign-plate-ids"></span><h2><a class="toc-backref" href="#id16">Load <em>points</em> from a GMT file and assign plate IDs</a><a class="headerlink" href="#load-points-from-a-gmt-file-and-assign-plate-ids" title="Permalink to this headline">¶</a></h2>
<p>This example is similiar to <a class="reference internal" href="#pygplates-import-points-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import points from a text file and assign plate IDs</span></a> except it
takes advantage of the ability of pyGPlates to load a GMT file to avoid having to manually parse a text file line-by-line.</p>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id17">Sample code</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a GMT file (instead of manually reading a &#39;.txt&#39; file line-by-line).</span>
<span class="n">point_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;input_points.gmt&#39;</span><span class="p">)</span>

<span class="c1"># Use the static polygons to assign plate IDs and valid time periods.</span>
<span class="c1"># Each point feature is partitioned into one of the static polygons and assigned its</span>
<span class="c1"># reconstruction plate ID and valid time period.</span>
<span class="n">assigned_point_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">partition_into_plates</span><span class="p">(</span>
    <span class="n">static_polygons_filename</span><span class="p">,</span>
    <span class="n">rotation_model</span><span class="p">,</span>
    <span class="n">point_features</span><span class="p">,</span>
    <span class="n">properties_to_copy</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">reconstruction_plate_id</span><span class="p">,</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">valid_time_period</span><span class="p">])</span>

<span class="c1"># Write the assigned point features to the output GPML file (ready for use in GPlates).</span>
<span class="n">assigned_point_feature_collection</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">assigned_point_features</span><span class="p">)</span>
<span class="n">assigned_point_feature_collection</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_points_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id18">Input</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>An example input text file (in longitude/latitude order) looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">79.747867</span>      <span class="o">-</span><span class="mf">1.444159</span>
<span class="o">-</span><span class="mf">79.786712</span>      <span class="o">-</span><span class="mf">1.654002</span>
<span class="o">-</span><span class="mf">79.872547</span>      <span class="o">-</span><span class="mf">2.221801</span>
<span class="o">-</span><span class="mf">79.858122</span>      <span class="o">-</span><span class="mf">6.951201</span>
<span class="o">-</span><span class="mf">78.850008</span>      <span class="o">-</span><span class="mf">9.359851</span>
<span class="o">-</span><span class="mf">76.020448</span>      <span class="o">-</span><span class="mf">13.798207</span>
<span class="o">-</span><span class="mf">75.549659</span>      <span class="o">-</span><span class="mf">14.315297</span>
<span class="o">-</span><span class="mf">75.411320</span>      <span class="o">-</span><span class="mf">14.456342</span>
<span class="o">-</span><span class="mf">74.335501</span>      <span class="o">-</span><span class="mf">15.543422</span>
<span class="o">-</span><span class="mf">72.539796</span>      <span class="o">-</span><span class="mf">17.187214</span>
<span class="o">-</span><span class="mf">71.922547</span>      <span class="o">-</span><span class="mf">17.773935</span>
<span class="o">-</span><span class="mf">71.381735</span>      <span class="o">-</span><span class="mf">18.373316</span>
<span class="o">-</span><span class="mf">70.979182</span>      <span class="o">-</span><span class="mf">18.850190</span>
<span class="o">-</span><span class="mf">70.786266</span>      <span class="o">-</span><span class="mf">19.126329</span>
<span class="o">-</span><span class="mf">70.571175</span>      <span class="o">-</span><span class="mf">19.417365</span>
<span class="o">-</span><span class="mf">70.343507</span>      <span class="o">-</span><span class="mf">19.716224</span>
<span class="o">-</span><span class="mf">70.280285</span>      <span class="o">-</span><span class="mf">19.858811</span>
<span class="o">-</span><span class="mf">70.107565</span>      <span class="o">-</span><span class="mf">20.531859</span>
<span class="o">-</span><span class="mf">70.059697</span>      <span class="o">-</span><span class="mf">22.248895</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id19">Details</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Since <a class="reference external" href="http://www.gplates.org">GPlates</a> can directly load GMT <code class="docutils literal notranslate"><span class="pre">'.gmt'</span></code> files, an alternative is to
change the filename extension, of your text file, to <code class="docutils literal notranslate"><span class="pre">'.gmt'</span></code>. The feature metadata will be missing
from your text file so only the geometry data will get loaded, but this achieves the same effect
as the above example.</div>
<div class="line">As with the previous example, there can be more than two numbers per line, but only the first two
are used (as longitude and latitude) - note that if you were to load your <code class="docutils literal notranslate"><span class="pre">'.gmt'</span></code> file into GPlates
the extra data would cause it to give a warning about flattening 2.5D to 2D.</div>
<div class="line">Note that, as with the previous example, the data should be in GMT (longitude/latitude) order.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;input_points.gmt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The rest of the sample code is similar to <a class="reference internal" href="#pygplates-import-points-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import points from a text file and assign plate IDs</span></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygplates-import-points-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import points from a text file and assign plate IDs</span></a></p>
</div>
</div>
</div>
<div class="section" id="import-polylines-from-a-text-file-and-assign-plate-ids">
<span id="pygplates-import-polylines-from-a-text-file-and-assign-plate-ids"></span><h2><a class="toc-backref" href="#id20">Import <em>polylines</em> from a text file and assign plate IDs</a><a class="headerlink" href="#import-polylines-from-a-text-file-and-assign-plate-ids" title="Permalink to this headline">¶</a></h2>
<p>This example is similiar to <a class="reference internal" href="#pygplates-import-points-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import points from a text file and assign plate IDs</span></a> except
it imports <em>polylines</em> instead of <em>points</em>.</p>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id21">Sample code</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygplates</span>


<span class="c1"># A function that create a polyline feature from some points and adds to a list of features.</span>
<span class="k">def</span> <span class="nf">add_polyline_feature_from_points</span><span class="p">(</span><span class="n">polyline_features</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">line_number</span><span class="p">):</span>

    <span class="c1"># If have no points then nothing to do.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">points</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Need at least two points for a polyline.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">polyline</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">PolylineOnSphere</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="n">polyline_feature</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">Feature</span><span class="p">()</span> <span class="c1"># &#39;unclassified&#39; feature</span>
        <span class="n">polyline_feature</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">polyline</span><span class="p">)</span>

        <span class="n">polyline_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polyline_feature</span><span class="p">)</span>

    <span class="c1"># If only one point then emit warning.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring polyline - polyline has only one point.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">line_number</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Clear points list for next feature.</span>
    <span class="c1"># Clear the list in-place so that all references to the list see an empty list.</span>
    <span class="k">del</span> <span class="n">points</span><span class="p">[:]</span>


<span class="c1"># Load one or more rotation files into a rotation model.</span>
<span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>

<span class="c1"># The static polygons file will be used to assign plate IDs and valid time periods.</span>
<span class="n">static_polygons_filename</span> <span class="o">=</span> <span class="s1">&#39;static_polygons.gpml&#39;</span>

<span class="c1"># Filename of the input polylines file that we will read.</span>
<span class="n">input_polylines_filename</span> <span class="o">=</span> <span class="s1">&#39;input_polylines.txt&#39;</span>

<span class="c1"># Filename of the output polylines file that we will write.</span>
<span class="c1"># Note that it is a GPML file (has extension &#39;.gpml&#39;).</span>
<span class="c1"># This enables it to be read into GPlates.</span>
<span class="n">output_polylines_filename</span> <span class="o">=</span> <span class="s1">&#39;output_polylines.gpml&#39;</span>

<span class="c1"># Parse the input polylines text file containing groups of lon/lat points per line.</span>
<span class="c1"># Longitude/latitude is the order that GMT files (&#39;.xy&#39;, &#39;.gmt&#39;) use.</span>
<span class="c1"># Note that pyGPlates specifies points in the opposite (latitude/longitude) order.</span>
<span class="n">polyline_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">polyline_points</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_polylines_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_polylines_file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_polylines_file</span><span class="p">):</span>

        <span class="c1"># Make line number 1-based instead of 0-based.</span>
        <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># See if line begins with &#39;&gt;&#39;.</span>
        <span class="c1"># This is was separates groups of points into polylines.</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>

            <span class="c1"># Generate the previous polyline feature if we have two or more points.</span>
            <span class="n">add_polyline_feature_from_points</span><span class="p">(</span><span class="n">polyline_features</span><span class="p">,</span> <span class="n">polyline_points</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>

            <span class="c1"># Skip to next line.</span>
            <span class="k">continue</span>

        <span class="c1"># Split the line into strings (separated by whitespace).</span>
        <span class="n">line_string_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="c1"># Need at least two strings per line (for latitude and longitude).</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring point - line does not have at least two white-space separated strings.&#39;</span> <span class="o">%</span> <span class="n">line_number</span>
            <span class="k">continue</span>

        <span class="c1"># Attempt to convert each string into a floating-point number.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Use GMT (lon/lat) order.</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring point - cannot read lon/lat values.&#39;</span> <span class="o">%</span> <span class="n">line_number</span>
            <span class="k">continue</span>

        <span class="c1"># Create a pyGPlates point from the latitude and longitude, and add it to our list of points.</span>
        <span class="c1"># Note that pyGPlates uses the opposite (lat/lon) order to GMT (lon/lat).</span>
        <span class="n">polyline_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pygplates</span><span class="o">.</span><span class="n">PointOnSphere</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">))</span>

    <span class="c1"># If we have any points leftover then generate the last polyline feature.</span>
    <span class="c1"># This happens if last line does not start with &#39;&gt;&#39;.</span>
    <span class="n">add_polyline_feature_from_points</span><span class="p">(</span><span class="n">polyline_features</span><span class="p">,</span> <span class="n">polyline_points</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>

<span class="c1"># Use the static polygons to assign plate IDs and valid time periods.</span>
<span class="c1"># Each polyline feature is partitioned into one or more of the static polygons and assigned their</span>
<span class="c1"># reconstruction plate IDs and valid time periods.</span>
<span class="n">assigned_polyline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">partition_into_plates</span><span class="p">(</span>
    <span class="n">static_polygons_filename</span><span class="p">,</span>
    <span class="n">rotation_model</span><span class="p">,</span>
    <span class="n">polyline_features</span><span class="p">,</span>
    <span class="n">properties_to_copy</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">reconstruction_plate_id</span><span class="p">,</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">valid_time_period</span><span class="p">])</span>

<span class="c1"># Write the assigned polyline features to the output GPML file (ready for use in GPlates).</span>
<span class="n">assigned_polyline_feature_collection</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">assigned_polyline_features</span><span class="p">)</span>
<span class="n">assigned_polyline_feature_collection</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_polylines_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id22">Input</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>An example input text file (in longitude/latitude order) containing three polylines looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span>
  <span class="o">-</span><span class="mf">79.747867</span>      <span class="o">-</span><span class="mf">1.444159</span>
  <span class="o">-</span><span class="mf">79.786712</span>      <span class="o">-</span><span class="mf">1.654002</span>
  <span class="o">-</span><span class="mf">79.872547</span>      <span class="o">-</span><span class="mf">2.221801</span>
  <span class="o">-</span><span class="mf">79.858122</span>      <span class="o">-</span><span class="mf">6.951201</span>
  <span class="o">-</span><span class="mf">78.850008</span>      <span class="o">-</span><span class="mf">9.359851</span>
  <span class="o">-</span><span class="mf">76.020448</span>      <span class="o">-</span><span class="mf">13.798207</span>
<span class="o">&gt;</span>
  <span class="o">-</span><span class="mf">75.549659</span>      <span class="o">-</span><span class="mf">14.315297</span>
  <span class="o">-</span><span class="mf">75.411320</span>      <span class="o">-</span><span class="mf">14.456342</span>
  <span class="o">-</span><span class="mf">74.335501</span>      <span class="o">-</span><span class="mf">15.543422</span>
  <span class="o">-</span><span class="mf">72.539796</span>      <span class="o">-</span><span class="mf">17.187214</span>
  <span class="o">-</span><span class="mf">71.922547</span>      <span class="o">-</span><span class="mf">17.773935</span>
  <span class="o">-</span><span class="mf">71.381735</span>      <span class="o">-</span><span class="mf">18.373316</span>
  <span class="o">-</span><span class="mf">70.979182</span>      <span class="o">-</span><span class="mf">18.850190</span>
  <span class="o">-</span><span class="mf">70.786266</span>      <span class="o">-</span><span class="mf">19.126329</span>
<span class="o">&gt;</span>
  <span class="o">-</span><span class="mf">70.571175</span>      <span class="o">-</span><span class="mf">19.417365</span>
  <span class="o">-</span><span class="mf">70.343507</span>      <span class="o">-</span><span class="mf">19.716224</span>
  <span class="o">-</span><span class="mf">70.280285</span>      <span class="o">-</span><span class="mf">19.858811</span>
  <span class="o">-</span><span class="mf">70.107565</span>      <span class="o">-</span><span class="mf">20.531859</span>
  <span class="o">-</span><span class="mf">70.059697</span>      <span class="o">-</span><span class="mf">22.248895</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> symbol is used to group points into polylines.</p>
</div>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id23">Details</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>The rotations are loaded from a rotation file into a <a class="reference internal" href="../generated/pygplates.RotationModel.html#pygplates.RotationModel" title="pygplates.RotationModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.RotationModel</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rotation_model</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">RotationModel</span><span class="p">(</span><span class="s1">&#39;rotations.rot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The polylines will be read from an input text file and written to an output GPML file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_polylines_filename</span> <span class="o">=</span> <span class="s1">&#39;input_polylines.txt&#39;</span>
<span class="n">output_polylines_filename</span> <span class="o">=</span> <span class="s1">&#39;output_polylines.gpml&#39;</span>
</pre></div>
</div>
<p>The input polylines file is opened and read line-by-line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_polylines_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_polylines_file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_polylines_file</span><span class="p">):</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">If a line begins with a <code class="docutils literal notranslate"><span class="pre">'&gt;'</span></code> character then it separates those points in lines before it
into one polyline and those points in lines after it into another polyline.</div>
<div class="line">Here the points in prior lines are used to create a new polyline feature.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
    <span class="n">add_polyline_feature_from_points</span><span class="p">(</span><span class="n">polyline_features</span><span class="p">,</span> <span class="n">polyline_points</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
    <span class="k">continue</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Each line contains a latitude string and a longitude string.</div>
<div class="line">We attempt to convert them to floating-point numbers.</div>
<div class="line">If that fails then we catch the <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception that Python raises and ignore that line in the file.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_string_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s1">&#39;Line </span><span class="si">%d</span><span class="s1">: Ignoring point - cannot read lon/lat values.&#39;</span> <span class="o">%</span> <span class="n">line_number</span>
    <span class="k">continue</span>
</pre></div>
</div>
<p>Keep track of the points for the current polyline so we can create the polyline once we’ve
reached the last point (of the current polyline).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">polyline_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pygplates</span><span class="o">.</span><span class="n">PointOnSphere</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">))</span>
</pre></div>
</div>
<p>Then function <code class="docutils literal notranslate"><span class="pre">add_polyline_feature_from_points</span></code> creates a polyline feature from a list
of points and adds it to a list of polyline features.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_polyline_feature_from_points</span><span class="p">(</span><span class="n">polyline_features</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">line_number</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>If there are at least two points (required for a polyline) then a <a class="reference internal" href="../generated/pygplates.PolylineOnSphere.html#pygplates.PolylineOnSphere" title="pygplates.PolylineOnSphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.PolylineOnSphere</span></code></a>
geometry is created from the points.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">polyline</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">PolylineOnSphere</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">An unclassified feature is created for each polyline we read from the input file.
Leaving the feature type empty in <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.__init__" title="pygplates.Feature.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.Feature()</span></code></a>
defaults to a feature type of <code class="docutils literal notranslate"><span class="pre">pygplates.FeatureType.gpml_unclassified_feature</span></code>.</div>
<div class="line">Ideally we should pick a specific feature type such as
<a class="reference external" href="http://www.gplates.org/docs/gpgim/#gpml:SubductionZone">pygplates.FeatureType.gpml_subduction_zone</a>.</div>
<div class="line">And ideally we should also import extra metadata such as feature <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_name" title="pygplates.Feature.set_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">name</span></code></a>
and <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_description" title="pygplates.Feature.set_description"><code class="xref py py-meth docutils literal notranslate"><span class="pre">description</span></code></a>.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">polyline_feature</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">Feature</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The polyline geometry is set on the polyline feature using <a class="reference internal" href="../generated/pygplates.Feature.html#pygplates.Feature.set_geometry" title="pygplates.Feature.set_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.Feature.set_geometry()</span></code></a>.</div>
<div class="line">If we don’t do this then the feature cannot be used in spatial calculations and
will not display on the globe in GPlates.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">polyline_feature</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">polyline</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Each polyline feature is partitioned into one or more of the static polygons and assigned their
reconstruction plate IDs and valid time periods using <a class="reference internal" href="../generated/pygplates.partition_into_plates.html#pygplates.partition_into_plates" title="pygplates.partition_into_plates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygplates.partition_into_plates()</span></code></a>.</div>
<div class="line">Note that the default argument for the <em>partition_method</em> parameter is <em>pygplates.PartitionMethod.split_into_plates</em>
which results in two polylines being generated (returned) when one polyline intersects two static polygons (plates).</div>
<div class="line">The static polygons have global coverage at present day (the default reconstruction time
for <a class="reference internal" href="../generated/pygplates.partition_into_plates.html#pygplates.partition_into_plates" title="pygplates.partition_into_plates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygplates.partition_into_plates()</span></code></a>) and should therefore partition all the input polylines.</div>
<div class="line">We also explicitly specify the argument <em>properties_to_copy</em> to assign both the reconstruction plate
ID and valid time period (the default is just to assign the reconstruction plate ID).</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">assigned_polyline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">partition_into_plates</span><span class="p">(</span>
    <span class="n">static_polygons_filename</span><span class="p">,</span>
    <span class="n">rotation_model</span><span class="p">,</span>
    <span class="n">polyline_features</span><span class="p">,</span>
    <span class="n">properties_to_copy</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">reconstruction_plate_id</span><span class="p">,</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">valid_time_period</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally we put the list of assigned features into a <a class="reference internal" href="../generated/pygplates.FeatureCollection.html#pygplates.FeatureCollection" title="pygplates.FeatureCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygplates.FeatureCollection</span></code></a> so that
we can write them out to a file using <a class="reference internal" href="../generated/pygplates.FeatureCollection.html#pygplates.FeatureCollection.write" title="pygplates.FeatureCollection.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pygplates.FeatureCollection.write()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">assigned_polyline_feature_collection</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">assigned_polyline_features</span><span class="p">)</span>
<span class="n">assigned_polyline_feature_collection</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_polylines_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-polylines-from-a-gmt-file-and-assign-plate-ids">
<span id="pygplates-import-polylines-from-a-gmt-file-and-assign-plate-ids"></span><h2><a class="toc-backref" href="#id24">Load <em>polylines</em> from a GMT file and assign plate IDs</a><a class="headerlink" href="#load-polylines-from-a-gmt-file-and-assign-plate-ids" title="Permalink to this headline">¶</a></h2>
<p>This example is similiar to <a class="reference internal" href="#pygplates-import-polylines-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import polylines from a text file and assign plate IDs</span></a> except it
takes advantage of the ability of pyGPlates to load a GMT file to avoid having to manually parse a text file line-by-line.</p>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id25">Sample code</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a GMT file (instead of manually reading a &#39;.txt&#39; file line-by-line).</span>
<span class="n">polyline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;input_polylines.gmt&#39;</span><span class="p">)</span>

<span class="c1"># Use the static polygons to assign plate IDs and valid time periods.</span>
<span class="c1"># Each polyline feature is partitioned into one or more of the static polygons and assigned their</span>
<span class="c1"># reconstruction plate IDs and valid time periods.</span>
<span class="n">assigned_polyline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">partition_into_plates</span><span class="p">(</span>
    <span class="n">static_polygons_filename</span><span class="p">,</span>
    <span class="n">rotation_model</span><span class="p">,</span>
    <span class="n">polyline_features</span><span class="p">,</span>
    <span class="n">properties_to_copy</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">reconstruction_plate_id</span><span class="p">,</span>
        <span class="n">pygplates</span><span class="o">.</span><span class="n">PartitionProperty</span><span class="o">.</span><span class="n">valid_time_period</span><span class="p">])</span>

<span class="c1"># Write the assigned polyline features to the output GPML file (ready for use in GPlates).</span>
<span class="n">assigned_polyline_feature_collection</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">assigned_polyline_features</span><span class="p">)</span>
<span class="n">assigned_polyline_feature_collection</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_polylines_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id26">Input</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>An example input text file (in longitude/latitude order) containing three polylines looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span>
  <span class="o">-</span><span class="mf">79.747867</span>      <span class="o">-</span><span class="mf">1.444159</span>
  <span class="o">-</span><span class="mf">79.786712</span>      <span class="o">-</span><span class="mf">1.654002</span>
  <span class="o">-</span><span class="mf">79.872547</span>      <span class="o">-</span><span class="mf">2.221801</span>
  <span class="o">-</span><span class="mf">79.858122</span>      <span class="o">-</span><span class="mf">6.951201</span>
  <span class="o">-</span><span class="mf">78.850008</span>      <span class="o">-</span><span class="mf">9.359851</span>
  <span class="o">-</span><span class="mf">76.020448</span>      <span class="o">-</span><span class="mf">13.798207</span>
<span class="o">&gt;</span>
  <span class="o">-</span><span class="mf">75.549659</span>      <span class="o">-</span><span class="mf">14.315297</span>
  <span class="o">-</span><span class="mf">75.411320</span>      <span class="o">-</span><span class="mf">14.456342</span>
  <span class="o">-</span><span class="mf">74.335501</span>      <span class="o">-</span><span class="mf">15.543422</span>
  <span class="o">-</span><span class="mf">72.539796</span>      <span class="o">-</span><span class="mf">17.187214</span>
  <span class="o">-</span><span class="mf">71.922547</span>      <span class="o">-</span><span class="mf">17.773935</span>
  <span class="o">-</span><span class="mf">71.381735</span>      <span class="o">-</span><span class="mf">18.373316</span>
  <span class="o">-</span><span class="mf">70.979182</span>      <span class="o">-</span><span class="mf">18.850190</span>
  <span class="o">-</span><span class="mf">70.786266</span>      <span class="o">-</span><span class="mf">19.126329</span>
<span class="o">&gt;</span>
  <span class="o">-</span><span class="mf">70.571175</span>      <span class="o">-</span><span class="mf">19.417365</span>
  <span class="o">-</span><span class="mf">70.343507</span>      <span class="o">-</span><span class="mf">19.716224</span>
  <span class="o">-</span><span class="mf">70.280285</span>      <span class="o">-</span><span class="mf">19.858811</span>
  <span class="o">-</span><span class="mf">70.107565</span>      <span class="o">-</span><span class="mf">20.531859</span>
  <span class="o">-</span><span class="mf">70.059697</span>      <span class="o">-</span><span class="mf">22.248895</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> symbol is used by GMT to group points into polylines.</p>
</div>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id27">Details</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Since <a class="reference external" href="http://www.gplates.org">GPlates</a> can directly load GMT <code class="docutils literal notranslate"><span class="pre">'.gmt'</span></code> files, an alternative is to
change the filename extension, of your text file, to <code class="docutils literal notranslate"><span class="pre">'.gmt'</span></code>. The feature metadata will be missing
from your text file so only the geometry data will get loaded, but this achieves the same effect
as the above example.</div>
<div class="line">As with the previous example, there can be more than two numbers per line, but only the first two
are used (as longitude and latitude) - note that if you were to load your <code class="docutils literal notranslate"><span class="pre">'.gmt'</span></code> file into GPlates
the extra data would cause it to give a warning about flattening 2.5D to 2D.</div>
<div class="line">Note that, as with the previous example, the data should be in GMT (longitude/latitude) order.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">polyline_features</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;input_polylines.gmt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The rest of the sample code is similar to <a class="reference internal" href="#pygplates-import-polylines-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import polylines from a text file and assign plate IDs</span></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygplates-import-polylines-from-a-text-file-and-assign-plate-ids"><span class="std std-ref">Import polylines from a text file and assign plate IDs</span></a></p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Import geometries and assign plate IDs</a><ul>
<li><a class="reference internal" href="#import-points-from-a-text-file-and-assign-plate-ids">Import <em>points</em> from a text file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#sample-code">Sample code</a></li>
<li><a class="reference internal" href="#input">Input</a></li>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-points-from-a-gmt-file-and-assign-plate-ids">Load <em>points</em> from a GMT file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#id1">Sample code</a></li>
<li><a class="reference internal" href="#id2">Input</a></li>
<li><a class="reference internal" href="#id3">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#import-polylines-from-a-text-file-and-assign-plate-ids">Import <em>polylines</em> from a text file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#id5">Sample code</a></li>
<li><a class="reference internal" href="#id6">Input</a></li>
<li><a class="reference internal" href="#id7">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-polylines-from-a-gmt-file-and-assign-plate-ids">Load <em>polylines</em> from a GMT file and assign plate IDs</a><ul>
<li><a class="reference internal" href="#id8">Sample code</a></li>
<li><a class="reference internal" href="#id9">Input</a></li>
<li><a class="reference internal" href="#id10">Details</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../pygplates_sample_code.html"
                        title="previous chapter">Sample code</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pygplates_load_and_save_feature_collections.html"
                        title="next chapter">Load and save feature collections</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/sample-code/pygplates_import_geometries_and_assign_plate_ids.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pygplates_load_and_save_feature_collections.html" title="Load and save feature collections"
             >next</a> |</li>
        <li class="right" >
          <a href="../pygplates_sample_code.html" title="Sample code"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pygplates 2.2.0.28 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../pygplates_sample_code.html" >Sample code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright (C) 2003-2020 The University of Sydney, Australia
(C) 2004-2020 California Institute of Technology
(C) 2007-2020 The Geological Survey of Norway
.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>